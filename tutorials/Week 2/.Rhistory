setwd("C:/Users/Usuario/Documents/GitHub/StatsII_2026/tutorials/Week 2")
data_raw <- read_excel("cbg_turnover_v23upload.xlsx")
library(readxl)
data_raw <- read_excel("cbg_turnover_v23upload.xlsx")
lapply(c("tidyverse", "ggplot2", "readxl"), pkgTest)
library(tidyverse)
library(ggplot2)
library(pkgconfig)
lapply(c("tidyverse", "ggplot2", "readxl"), pkgTest)
library(pkgtest)
library(pkgTest)
data <- data_raw %>%
select(
codewdi,
country,
year,
'time to regular turnover',
'regular turnover dummy',
'irregular turnover dummy',
'legal duration'
) %>%
mutate(
codewdi = as.factor(codewdi),
country = as.factor(country),
year = as.integer(year),
time_to_regular_turnover = as.integer(`time to regular turnover`),
regular_turnover = as.integer('regular turnover dummy'),
irregular_turnover = as.integer('irregular turnover dummy'),
legal_duration = as.integer('legal duration')
) %>%
drop_na()
data_raw <- read_excel("data_tutorial2.xlsx")
data <- data_raw %>%
select(
codewdi,
country,
year,
'time to regular turnover',
'regular turnover dummy',
'irregular turnover dummy',
'legal duration'
) %>%
mutate(
codewdi = as.factor(codewdi),
country = as.factor(country),
year = as.integer(year),
time_to_regular_turnover = as.integer(`time to regular turnover`),
regular_turnover = as.integer('regular turnover dummy'),
irregular_turnover = as.integer('irregular turnover dummy'),
legal_duration = as.integer('legal duration')
) %>%
drop_na()
data <- data_raw %>%
select(
codewdi,
country,
year,
'time to regular turnover',
'regular turnover dummy',
'irregular turnover dummy',
'legal duration'
) %>%
mutate(
codewdi = as.factor(codewdi),
country = as.factor(country),
year = as.integer(year),
time_to_regular_turnover = as.integer(`time to regular turnover`),
regular_turnover = as.integer('regular turnover dummy'),
irregular_turnover = as.integer('irregular turnover dummy'),
legal_duration = as.integer('legal duration')
) %>%
drop_na()
data <- data_raw %>%
select(
codewdi,
country,
year,
'time to regular turnover',
'regular turnover dummy',
'irregular turnover dummy',
'legal duration'
) %>%
mutate(
codewdi = as.factor(codewdi),
country = as.factor(country),
year = as.integer(year),
time_to_regular_turnover = as.integer('time to regular turnover'),
regular_turnover = as.integer('regular turnover dummy'),
irregular_turnover = as.integer('irregular turnover dummy'),
legal_duration = as.integer('legal duration')
) %>%
drop_na()
data <- data_raw %>%
select(
codewdi,
country,
year,
`time to regular turnover`,
`regular turnover dummy`,
`irregular turnover dummy`,
`legal duration`
) %>%
mutate(
codewdi = as.factor(codewdi),
country = as.factor(country),
year = as.integer(year),
time_to_regular_turnover = as.integer(`time to regular turnover`),
regular_turnover = as.integer(`regular turnover dummy`),
irregular_turnover = as.integer(`irregular turnover dummy`),
legal_duration = as.integer(`legal duration`)
) %>%
drop_na()
bad_codes <- c(-999, -666, -555, -881)
data <- data %>%
mutate(
across(
c(year, time_to_regular_turnover, regular_turnover,
irregular_turnover, legal_duration
),
~ replace(., . %in% bad_codes, NA)
)
)
unique(data$regular_turnover)
data <- data %>% drop_na()
country_turnover <- data %>%
group_by(country) %>%
summarize(
avg_turnover = mean(irregular_turnover),
n = n()
)
View(country_turnover)
country_turnover %>%
arrange(desc(avg_turnover)) %>%
slice(1:5)
country_turnover %>%
arrange(asc(avg_turnover)) %>%
slice(1:5)
country_turnover %>%
arrange(avg_turnover) %>%
slice(1:5)
View(data)
lpm <- lm(irregular_turnover_dummy ~ time_to_regular_turnover + legal_duration, data = data)
lpm <- lm(irregular turnover dummy ~ time_to_regular_turnover + legal_duration, data = data)
lpm <- lm(irregular turnover dummy ~ time to regular turnover + legal duration, data = data)
lpm <- lm(irregular turnover dummy ~ time_to_regular_turnover + legal_duration, data = data)
lpm <- lm(`irregular turnover dummy` ~ time_to_regular_turnover + legal_duration, data = data)
lpm <- lm(`irregular turnover dummy` ~ `time to regular turnover` + `legal duration`, data = data)
